/**
 * jquery.custom.js
 * 
 * Custom scripts for Experience WordPress Theme by EugeneO.
 * 
 * Copyright 2016 EugeneO
 * http://eugeneo.com
 * http://themeforest.net/user/EugeneO/portfolio
 *
 **/

function expCenterSectionPagination(){"use strict";jQuery(".section-pagination").each(function(){var e,n=(jQuery("#wpadminbar").height(),jQuery(this).height()),t=jQuery(this).parent(),a=jQuery(t).offset().top+100+n/2,i=jQuery(t).offset().top+jQuery(t).height()-100-n/2,s=Math.ceil(jQuery(window).scrollTop()+jQuery(window).height()/2);s>a?s>i?(e=jQuery(t).height()-100-jQuery(this).height(),jQuery(this).css({position:"absolute",top:e})):(e=jQuery(window).height()/2-jQuery(this).height()/2,jQuery(this).css({position:"fixed",top:e})):jQuery(this).css({position:"",top:""})})}function expResizeFillScreen(){"use strict";jQuery(".section-header[data-fill-screen], .flexslider[data-fill-screen], [data-fill-screen] > .vc_column_container").each(function(){var e,n,t,a,i,s=0,o=jQuery(this);e=jQuery(window).height(),n=jQuery("#wpadminbar").height(),o.hasClass("section-header")||o.hasClass("flexslider")&&o.parent().parent().hasClass("section-wrapper")?(jQuery("body").hasClass("nav-transparent")||(n+=jQuery(".site-header").height()),t=e-n,o.css("height",t)):(o.closest(".section-content-wrapper").is(":first-child")&&!o.prev().length&&(n+=jQuery(".site-header").height()),o.hasClass("flexslider")?o.closest(".wpb_wrapper").prev().length||o.closest(".wpb_wrapper").next().length||(a=o.closest(".row-container"),i=a.innerHeight()-a.height(),e-=i,t=e-n,o.css("height",t)):(s=0,o.find(".vertically-center").length&&(s=o.find(".vertically-center").height()),s>e?t=s:(a=o.closest(".row-container"),i=a.innerHeight()-a.height(),e-=i,t=e-n),o.css("height",t)))})}function expInitSite(){var e=jQuery("#page-preloader"),n=new sPreloader({contentDiv:"content",loaderDiv:"page-preloader",excludingClass:"nopreload",logProgress:!1,animation:"fade",animationSpeed:"1.0"});n.start(),document.addEventListener("preloadUpdate",function(){}),document.addEventListener("preloaded",function(){jQuery(".gallery").masonry({itemSelector:".gallery-item"}),expResizeFillScreen(),expCenterSectionPagination(),e.fadeOut(1e3),jQuery("#preloadImages").remove()})}jQuery(document).ready(function(e){"use strict";function n(){var n=e("body").scrollTop();Math.abs(p-n)<=d||(n>p&&n>u?e("body").addClass("nav-closed"):n+e(window).height()<e(document).height()&&e("body").removeClass("nav-closed"),p=n)}if(e(window).unload(function(){e(window).unbind("unload")}),e(window).bind("pageshow",function(e){e.originalEvent.persisted&&window.location.reload()}),e(".loader").fadeIn(500),window.addEventListener("DOMContentLoaded",expInitSite,!1),e("body").on("click",'a[href], button[href], .searchform input[type="submit"]',function(n){if(e(this).not(".comment-reply-link, #cancel-comment-reply-link")){var t=e(this).attr("href");if("undefined"==typeof t||void 0!=e(this).attr("onClick")||0==t.indexOf("#")||0==t.indexOf("javascript:")||"_blank"==e(this).attr("target")||" _blank"==e(this).attr("target")||e(this).is('[class*="lightbox"],[rel*="lightbox"]')||e(this).is('[class*="fancybox"],[rel*="fancybox"]')||e(this).is('[class*="colorbox"],[rel*="colorbox"]')||e(this).is('[class*="colorbox"],[rel*="colorbox"]')||e(this).parent().hasClass("menu-item-has-children"))return;n.preventDefault(),e(".loader").css({display:""}),e("#page-preloader").fadeIn(500,function(){window.location=t})}}),e(".panel-nav .menu > li").each(function(){if(e(this).hasClass("menu-item-has-children")&&""!=e(this).children("a").attr("href")&&"#"!=e(this).children("a").attr("href")){var n=e(this).clone();n.remove(".sub-menu");var t=e(".sub-menu",this);t.prepend(n);var a=e(this).find(".menu-item-has-children");a.attr("id","").removeClass("menu-item-has-children"),a.find(".sub-menu").remove()}}),e(".panel-nav .sub-menu").prepend('<li class="back"></li>'),e(".panel-nav .navigation-menu > .menu-item-has-children > a").on("click",function(e){e.preventDefault()}),e(".header-nav > li > span, .panel-nav .funky-icon-close").on("click",function(){e(".panel-active").length||(e(this).hasClass("search-toggle")?(e(".panel-nav-content > *").css({display:"none"}),e(".panel-nav-content .search-container").css({display:""})):e(this).hasClass("social-toggle")?(e(".panel-nav-content > *").css({display:"none"}),e(".panel-nav-content .social-container").css({display:""})):e(this).hasClass("language-toggle")?(e(".panel-nav-content > *").css({display:"none"}),e(".panel-nav-content .languages-container").css({display:""})):(e(".panel-nav-content > *").css({display:"none"}),e(this).hasClass("menu-icon")&&e(this).parent().hasClass("show-mobile")?e(".panel-nav-content .navigation-container").css({display:""}):e(".panel-nav-content .navigation-container").css({display:""}))),e(".panel-nav").removeClass("active-submenu"),e(".menu-item-has-children").removeClass("active"),setTimeout(function(){e("body").toggleClass("panel-active")},300)}),e(".menu-item-has-children a").each(function(){e(this).on("click",function(){e(".panel-nav").addClass("active-submenu"),e(this).parent().addClass("active"),e("body").addClass("nav-submenu-open")})}),e(".sub-menu .back").on("click",function(){e(".panel-nav").removeClass("active-submenu"),e(".menu-item-has-children").removeClass("active"),e("body").removeClass("nav-submenu-open")}),e(".panel-toggle-icons > li > span").on("click",function(){var n=e(this);e(".panel-nav").removeClass("active-submenu"),e(".menu-item-has-children").removeClass("active"),e(".panel-nav-content > *").fadeOut(300,function(){setTimeout(function(){e(n).hasClass("search-toggle")?e(".panel-nav-content .search-container").fadeIn():e(n).hasClass("social-toggle")?e(".panel-nav-content .social-container").fadeIn():e(n).hasClass("language-toggle")?e(".panel-nav-content .languages-container").fadeIn():e(".panel-nav-content .navigation-container").fadeIn()},350)})}),e(".section-scroll-link").click(function(n){n.preventDefault();var t,a;a=0+e("#wpadminbar").height(),e(this).closest(".section-header").next().length&&(t=e(".portfolio-meta").length?e(".portfolio-meta").offset().top-a:e(this).closest(".section-wrapper").find(".section-content-wrapper").offset().top-a),e("html, body").animate({scrollTop:t},900,"swing")}),e("[data-section-pagination]").length){var t='<ul class="section-pagination">',a=!0;e(".section-content > .post-content > .vc_row, .section-content > .post-content > .exp_iefixer-flexbox > .vc_row").each(function(){var n="";e(this).attr("id")&&(e(this).data("row-title")&&(n="<span>"+e(this).data("row-title")+"</span>"),1==a?(t=t+'<li><a class="active" href="#'+e(this).attr("id")+'"></a>'+n+"</li>",a=!1):t=t+'<li><a href="#'+e(this).attr("id")+'"></a>'+n+"</li>")}),t+="</ul>",e(".section-content").after(t)}if(e(".section-pagination a, a.back-to-top-link").click(function(n){n.preventDefault();var t=this.hash,a=e(t);e("html, body").stop().animate({scrollTop:a.offset().top},900,"swing",function(){window.location.hash=t}),e(".section-pagination a").removeClass("active"),e(this).addClass("active")}),e('a[href*="#"]:not([href="#"])').click(function(){if(!(e(this).parent().parent().hasClass("section-pagination")||e(this).parent().parent().hasClass("comments-navigation")||e(this).parent().parent().hasClass("vc_toggle_title")||e(this).parent().parent().hasClass("vc_tta-panel-heading")||e(this).parent().parent().hasClass("vc_tta-tab")||e(this).parent().hasClass("vc_tta-tab")||location.pathname.replace(/^\//,"")!=this.pathname.replace(/^\//,"")&&location.hostname!=this.hostname)){var n=e(this.hash);if(n=n.length?n:e("[name="+this.hash.slice(1)+"]"),n.length)return e("body").removeClass("panel-active"),e(".panel-nav-content > *").css({display:"none"}),e(".panel-nav-content .searchform").css({display:""}),e(".panel-nav-content .social-buttons").css({display:""}),e(".panel-nav-content .languages-menu").css({display:""}),e(".panel-nav-content .navigation-menu").css({display:""}),e(".panel-nav").removeClass("active-submenu"),e(".menu-item-has-children").removeClass("active"),e("html,body").animate({scrollTop:n.offset().top},1e3),!1}}),e(".post-navigation .next").length){var i,s=parseInt(e(".post-navigation .current").text(),10)+1,o=e(".post-navigation a").last().attr("href").replace(/\/$/,"");i=e(".post-navigation .next").attr("href").replace(/\/$/,""),o=e(".post-navigation .next").prev("a").attr("href").replace(/\/$/,""),o=o.match(/\d+/),o=o[0];var l=o.match(/[0-9]+/);if(l=l[0],l>=s){var r,c="";e(".post-navigation").hasClass("padding-v")?r="padding-v":e(".post-navigation").hasClass("padding-top")?r="padding-top":e(".post-navigation").hasClass("padding-bottom")&&(r="padding-bottom"),e(".post-navigation").hasClass("padding-h")&&(c="padding-h"),e(".post-navigation").remove(),e(".post-container").after('<div class="post-navigation '+r+" "+c+'"><a class="vc_btn3 ajax-load-posts-button" href="#">'+experience_load_posts.load_more_button_text+"</a></div>"),e(".ajax-load-posts-button").click(function(){if(l>=s){e(this).text(experience_load_posts.loading_text);var n=e("<div>");e(n).load(i+" .ajax-item",function(){e(n).find(".ajax-item").css("opacity",0),s++,i=i.replace(/\d+/,s);var t=e(n).html();e(".post-container").append(t),"undefined"!=typeof vc_rowBehaviour&&e.isFunction(vc_rowBehaviour)&&vc_rowBehaviour(),e(".ajax-item").animate({opacity:1}),l>=s?e(".ajax-load-posts-button").text(experience_load_posts.load_more_button_text):e(".post-navigation").remove()})}else e(".post-navigation").remove();return!1})}}var h,p=0,d=5,u=10;setInterval(function(){h&&(n(),h=!1)},250),"undefined"!=typeof flexslider&&e.isFunction(e.fn.flexslider)&&e(".section-wrapper > .section-header .flexslider").each(function(n,t){var a=e(t).data("flexslider-startat")-1,i=e(t).data("flexslider-slideshowspeed")||7e3,s=e(t).data("flexslider-animationspeed")||600;e(t).flexslider({animation:"slide",directionNav:!1,startAt:a,slideshowSpeed:i,animationSpeed:s,start:function(){}})}),e(".wpcf7").on("wpcf7:invalid wpcf7:mailfailed",function(n){e(".gallery").masonry(),expResizePostImages(),expResizeFillScreen(),expCenterSectionPagination()}),e(window).resize(function(){e(".gallery").masonry(),expResizeFillScreen(),expCenterSectionPagination()}),e(window).scroll(function(n){if(h=!0,e(".nav-transparent").length){var t=e(this).scrollTop(),a=e(".site-header").height()+e("#wpadminbar").height();t>a?e(".unscrolled").length&&e("body").removeClass("unscrolled"):e(".unscrolled").length||e("body").addClass("unscrolled")}expCenterSectionPagination()}),e(window).load(function(){if(e.isFunction(e.fn.waypoint)&&e("[data-section-pagination]").length&&(e(".section-content > .post-content > .vc_row, .section-content > .post-content > .exp_iefixer-flexbox > .vc_row").waypoint(function(n){"down"==n&&e(this).attr("id")&&(e(".section-pagination a").removeClass("active"),e('.section-pagination a[href="#'+e(this).attr("id")+'"]').addClass("active"))},{offset:function(){return e(window).height()/2+e("#wpadminbar").height()}}),e(".section-content > .post-content > .vc_row, .section-content > .post-content > .exp_iefixer-flexbox > .vc_row").waypoint(function(n){"up"==n&&e(this).attr("id")&&(e(".section-pagination a").removeClass("active"),e('.section-pagination a[href="#'+e(this).attr("id")+'"]').addClass("active"))},{offset:function(){return e(window).height()/2-e("#wpadminbar").height()-e(this).height()}})),e(".skrollable").length){var n=skrollr.init();n.refresh(e(".vc_parallax"))}})});