/*!
 * Fancy Countdown v1.0
 *
 * Copyright 2011, Rafael Dery
 *
 * Only for sale at the envato marketplaces
 */

(function(c){c.fancyCountdown={version:"1.0"};c.fn.fancyCountdown=function(P){function Q(){O=Date.UTC(a.year,a.month-1,a.day,a.hour-a.timezone,a.minute,a.second);var b=O-(new Date).getTime(),d=Math.floor(b/1E3),e=Math.floor(d/60),h=Math.floor(e/60),i=Math.floor(h/24);d%=60;e%=60;h%=24;var l=Math.floor(d%10);d=Math.floor(d/10);var o=Math.floor(e%10);e=Math.floor(e/10);var p=Math.floor(h%10);h=Math.floor(h/10);var q=Math.floor(i%10),r=Math.floor(Math.floor(i/10)%10);i=Math.floor(i/100);if(!t){E=l;F=
d;G=o;H=e;I=p;J=h;K=q;L=r;M=i;for(var k=-2,j=0;j<4;++j){if(a.digits.seconds){u[j].text(f(l+k,0,9));v[j].text(f(d+k,0,5))}if(a.digits.minutes){w[j].text(f(o+k,0,9));x[j].text(f(e+k,0,5))}if(a.digits.hours){y[j].text(f(p+k,0,9));z[j].text(f(h+k,0,2))}if(a.digits.days){A[j].text(f(q+k,0,9));B[j].text(f(r+k,0,9));C[j].text(f(i+k,0,9))}++k}Cufon.refresh(".fc-digitUnit")}t=true;if(b>0){if(E!=l){Cufon.refresh(".fc-digitUnit");a.digits.seconds&&m(u,f(l-2,0,9));E=l}if(F!=d){a.digits.seconds&&m(v,f(d-2,0,5));
F=d}if(G!=o){a.digits.minutes&&m(w,f(o-2,0,9));G=o}if(H!=e){a.digits.minutes&&m(x,f(e-2,0,5));H=e}if(I!=p){a.digits.hours&&m(y,f(p-2,0,9));I=p}if(J!=h){a.digits.hours&&m(z,f(h-2,0,2));J=h}if(K!=q){a.digits.days&&m(A,f(q-2,0,9));K=q}if(L!=r){a.digits.days&&m(B,f(r-2,0,9));L=r}if(M!=i){a.digits.days&&m(C,f(i-2,0,9));M=i}}else{c.fancyCountdown.stop();c.fancyCountdown.reset();a.callback();Cufon.refresh(".fc-digitUnit")}}function m(b,d){b[0].animate({top:-(c(b[0]).height()-a.topDigitOffset)},300);b[1].animate({top:0},
300);b[2].animate({top:a.digitUnitHeight-a.bottomDigitOffset},300);b[3].animate({top:a.digitUnitHeight},300,function(){var e=b.pop();c(e).css("top",-c(e).height()+"px");e.text(d);b.unshift(e)})}function f(b,d,e){return b<0?e+b+1:b>e?d+b-e-1:b}function n(b){g.prepend("<div style='width:"+a.digitUnitWidth+"px;height:"+a.digitUnitHeight+"px;background:"+a.fillColor+";' class='fc-digitUnit fc-"+b+"'><div class='fc-digits'><ul><li>8</li><li>9</li><li>0</li><li>1</li></ul></div><div style='width:"+a.digitUnitWidth+
"px;height:"+a.digitUnitHeight+"px;' class='fc-digitOverlay'></div></div>");b=g.children("div:first").find(".fc-digits li").css({width:a.digitUnitWidth+"px","line-height":a.digitUnitHeight+"px"});var d=[];d[0]=c(b[0]).css("top",-c(b[0]).height()+"px");d[1]=c(b[1]).css("top",-(c(b[0]).height()-a.topDigitOffset)+"px");d[2]=c(b[2]).css("top","0px");d[3]=c(b[3]).css("top",a.digitUnitHeight-a.bottomDigitOffset+"px");return d}function N(){g.prepend("<div style='width:"+a.colonUnitWidth+"px;height:"+a.digitUnitHeight+
"px;background:"+a.fillColor+";' class='fc-digitUnit'><div style='width:"+a.colonUnitWidth+"px;line-height:"+a.digitUnitHeight+"px;' class='fc-digitOverlay fc-colon'>:</div></div>")}function D(b,d){g.append("<div class='fc-captions'>"+b+"</div>");d-=g.find("div:last").width()*0.5;g.find("div:last").css({left:d,top:a.digitUnitHeight})}var a=c.extend({},c.fn.fancyCountdown.defaults,P),g,s,O,t=false,E,F,G,H,I,J,K,L,M,u,v,w,x,y,z,A,B,C;c.fancyCountdown.start=function(){if(!s){t=false;s=setInterval(Q,
100)}};c.fancyCountdown.stop=function(){if(s){clearInterval(s);s=null}};c.fancyCountdown.reset=function(){g.find(".fc-digits li").stop(true,true);for(var b=0;b<4;++b){if(a.digits.seconds){u[b].text((8+b)%10);v[b].text((4+b)%6)}if(a.digits.minutes){w[b].text((8+b)%10);x[b].text((4+b)%6)}if(a.digits.hours){y[b].text((8+b)%10);z[b].text((1+b)%3)}if(a.digits.days){A[b].text((8+b)%10);B[b].text((8+b)%10);C[b].text((8+b)%10)}}};c.fancyCountdown.fillColor=function(b){g.children(".fc-digitUnit").css("background",
b)};c.fancyCountdown.targetDate=function(b,d,e,h,i,l){h=h||0;i=i||0;l=l||0;a.year=parseInt(b);a.month=parseInt(d);a.day=parseInt(e);a.hour=parseInt(h);a.minute=parseInt(i);a.second=parseInt(l);t=false};c.fancyCountdown.timezone=function(b){a.timezone=parseFloat(b)};return this.each(function(){g=c(this);g.addClass("fc-panel");if(a.digits.seconds){u=n("seconds");v=n("seconds")}if(a.digits.minutes){a.digits.seconds&&N();w=n("minutes");x=n("minutes")}if(a.digits.hours){a.digits.minutes&&N();y=n("hours");
z=n("hours")}if(a.digits.days){a.digits.hours&&N();A=n("days");B=n("days");C=n("days")}if(a.captions){var b=parseInt(g.children(".fc-digitUnit").css("margin-right"))*0.5;a.digits.seconds&&D("seconds",c(g.children(".fc-seconds")[1]).position().left-b);a.digits.minutes&&D("minutes",c(g.children(".fc-minutes")[1]).position().left-b);a.digits.hours&&D("hours",c(g.children(".fc-hours")[1]).position().left-b);a.digits.days&&D("days",c(g.children(".fc-days")[1]).position().left+a.digitUnitWidth*0.5)}Cufon.now();
Cufon.replace(".fc-digitUnit",{fontFamily:a.fontName});a.autoStart&&c.fancyCountdown.start()})};c.fn.fancyCountdown.defaults={year:2012,month:12,day:31,hour:0,minute:0,second:0,digitUnitWidth:60,digitUnitHeight:80,colonUnitWidth:20,topDigitOffset:25,bottomDigitOffset:24,timezone:0,fillColor:"#005152",fontName:"Harabara",autoStart:true,captions:true,digits:{days:true,hours:true,minutes:true,seconds:true},callback:function(){}}})(jQuery);
